(()=>{"use strict";var e={6698:(e,t,o)=>{o(3792),o(3362),o(9085),o(9391);var n=o(5130),r=o(6768),i=o(4232);function c(e,t,o,n,c,l){var a=(0,r.g2)("Sidebar"),s=(0,r.g2)("MapView");return(0,r.uX)(),(0,r.CE)("div",{id:"app",class:(0,i.C4)({rtl:"ar"===e.$i18n.locale})},[(0,r.bF)(a),(0,r.bF)(s)],2)}var l=o(1034),a=o(4249),s={class:"sidebar"},u={class:"header"},d={class:"collections-list"},p={key:0,class:"loading"},v={key:1,class:"error"},h=["onClick"],f={class:"collection-toggle"},g=["checked","onChange"],m={class:"collection-title"};function C(e,t,o,n,c,l){var a=(0,r.g2)("LanguageSwitcher");return(0,r.uX)(),(0,r.CE)("div",s,[(0,r.Lk)("div",u,[(0,r.Lk)("h2",null,(0,i.v_)(e.$t("collections.title")),1),(0,r.bF)(a)]),(0,r.Lk)("div",d,[e.loading?((0,r.uX)(),(0,r.CE)("div",p,(0,i.v_)(e.$t("common.loading")),1)):e.error?((0,r.uX)(),(0,r.CE)("div",v,(0,i.v_)(e.error),1)):((0,r.uX)(!0),(0,r.CE)(r.FK,{key:2},(0,r.pI)(e.collections,(function(t){return(0,r.uX)(),(0,r.CE)("div",{key:t.id,class:"collection-item",onClick:function(e){return l.handleCollectionClick(t)}},[(0,r.Lk)("label",f,[(0,r.Lk)("input",{type:"checkbox",checked:e.isCollectionActive(t.id),onChange:function(e){return l.handleToggle(t)}},null,40,g),(0,r.Lk)("span",m,(0,i.v_)(t.title||t.id),1)]),(0,r.Lk)("div",{class:(0,i.C4)(["collection-type",t.itemType])},(0,i.v_)(t.itemType),3)],8,h)})),128))])])}var y={class:"language-switcher"};function w(e,t,o,n,c,l){return(0,r.uX)(),(0,r.CE)("div",y,[(0,r.Lk)("button",{onClick:t[0]||(t[0]=function(e){return l.switchLanguage("en")}),class:(0,i.C4)({active:"en"===l.currentLocale})},"English",2),(0,r.Lk)("button",{onClick:t[1]||(t[1]=function(e){return l.switchLanguage("ar")}),class:(0,i.C4)({active:"ar"===l.currentLocale})},"العربية",2)])}const A={name:"LanguageSwitcher",computed:{currentLocale:function(){return this.$i18n.locale}},methods:{switchLanguage:function(e){this.$i18n.locale=e,document.documentElement.dir="ar"===e?"rtl":"ltr",document.documentElement.lang=e}}};var b=o(1241);const L=(0,b.A)(A,[["render",w],["__scopeId","data-v-2b667963"]]),E=L,k={name:"Sidebar",components:{LanguageSwitcher:E},computed:(0,l.A)((0,l.A)({},(0,a.aH)(["collections","loading","error"])),(0,a.L8)(["isCollectionActive"])),methods:(0,l.A)((0,l.A)({},(0,a.i0)(["fetchCollections","toggleCollection"])),{},{handleCollectionClick:function(e){console.log("Collection clicked:",{id:e.id,title:e.title,type:e.itemType,wasActive:this.isCollectionActive(e.id)})},handleToggle:function(e){console.log("Toggle requested for collection:",{id:e.id,title:e.title,type:e.itemType,wasActive:this.isCollectionActive(e.id)}),this.toggleCollection(e.id)}}),mounted:function(){console.log("Sidebar mounted, fetching collections"),this.fetchCollections()}},x=(0,b.A)(k,[["render",C]]),T=x;var O={class:"map-container"};function I(e,t,o,n,i,c){return(0,r.uX)(),(0,r.CE)("div",O,t[0]||(t[0]=[(0,r.Lk)("div",{id:"map"},null,-1)]))}var M=o(1587),S=o(4048),_=o(388),V=(o(2008),o(113),o(1629),o(4423),o(2062),o(5086),o(5506),o(6099),o(1699),o(8992),o(4520),o(2577),o(3949),o(1454),o(7550),o(3500),o(6031),o(6886)),G=o.n(V);function N(){delete G().Icon.Default.prototype._getIconUrl,G().Icon.Default.mergeOptions({iconRetinaUrl:o(8249),iconUrl:o(7024),shadowUrl:o(1071)})}o(8706),o(8598);var R=o(6966),j="https://demo.pygeoapi.io/master",z=R.A.create({baseURL:j,headers:{"Content-Type":"application/json"}});function F(){return P.apply(this,arguments)}function P(){return P=(0,_.A)((0,S.A)().mark((function e(){var t;return(0,S.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Fetching collections"),e.next=4,z.get("/collections");case 4:return t=e.sent,e.abrupt("return",t.data.collections||[]);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error("Error fetching collections:",e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),P.apply(this,arguments)}function B(e){return D.apply(this,arguments)}function D(){return D=(0,_.A)((0,S.A)().mark((function e(t){var o;return(0,S.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Fetching collection details:",t),e.next=4,z.get("/collections/".concat(t));case 4:return o=e.sent,e.abrupt("return",o.data);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error("Error fetching collection details for ".concat(t,":"),e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),D.apply(this,arguments)}function $(e){return U.apply(this,arguments)}function U(){return U=(0,_.A)((0,S.A)().mark((function e(t){var o,n,r,i=arguments;return(0,S.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return o=i.length>1&&void 0!==i[1]?i[1]:{},e.prev=1,n=(0,l.A)((0,l.A)((0,l.A)((0,l.A)((0,l.A)({},o),{},{limit:o.limit||1e3},o.bbox&&{bbox:o.bbox.join(",")}),o.datetime&&{datetime:o.datetime}),o.properties&&{properties:o.properties.join(",")}),void 0!==o.skipGeometry&&{skipGeometry:o.skipGeometry}),console.log("Fetching features:",{collectionId:t,params:n}),e.next=6,z.get("/collections/".concat(t,"/items"),{params:n});case 6:return r=e.sent,e.abrupt("return",r.data);case 10:throw e.prev=10,e.t0=e["catch"](1),console.error("Error fetching features for ".concat(t,":"),e.t0),e.t0;case 14:case"end":return e.stop()}}),e,null,[[1,10]])}))),U.apply(this,arguments)}function X(e){return q.apply(this,arguments)}function q(){return q=(0,_.A)((0,S.A)().mark((function e(t){var o;return(0,S.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Fetching queryables:",t),e.next=4,z.get("/collections/".concat(t,"/queryables"));case 4:return o=e.sent,e.abrupt("return",o.data);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error("Error fetching queryables for ".concat(t,":"),e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),q.apply(this,arguments)}function Z(e){return"".concat(j,"/collections/").concat(e,"/coverage/wms")}function H(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"mvt",o="/collections/".concat(e,"mvt"===t?"/tiles/WebMercatorQuad/{z}/{x}/{y}":"/tiles/{z}/{x}/{y}");return"".concat(j).concat(o)}function W(e){return J.apply(this,arguments)}function J(){return J=(0,_.A)((0,S.A)().mark((function e(t){var o;return(0,S.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Fetching tile set info:",t),e.next=4,z.get("/collections/".concat(t,"/tiles"));case 4:return o=e.sent,e.abrupt("return",o.data);case 8:throw e.prev=8,e.t0=e["catch"](0),console.error("Error fetching tile set info for ".concat(t,":"),e.t0),e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,8]])}))),J.apply(this,arguments)}function K(e){var t,o,n;return console.log("Determining render type for collection:",e),null!==(t=e.links)&&void 0!==t&&t.some((function(e){var t;return"items"===e.rel||(null===(t=e.href)||void 0===t?void 0:t.includes("/items"))}))?(console.log("Detected feature collection"),"feature"):null!==(o=e.links)&&void 0!==o&&o.some((function(e){var t;return"coverage"===e.rel||(null===(t=e.href)||void 0===t?void 0:t.includes("/coverage"))}))?(console.log("Detected coverage collection"),"coverage"):null!==(n=e.links)&&void 0!==n&&n.some((function(e){var t;return"tiles"===e.rel||(null===(t=e.href)||void 0===t?void 0:t.includes("/tiles"))}))?(console.log("Detected tile collection"),"tiles"):(console.warn("Unknown collection type"),"unknown")}z.interceptors.request.use((function(e){return console.log("API Request:",{method:e.method,url:e.url,params:e.params,data:e.data}),e})),z.interceptors.response.use((function(e){return console.log("API Response:",{status:e.status,url:e.config.url,data:e.data}),e}),(function(e){var t;return console.error("API Error:",{message:e.message,config:e.config,response:null===(t=e.response)||void 0===t?void 0:t.data}),Promise.reject(e)}));const Q={name:"MapView",data:function(){return{map:null,layerGroups:{},layerColors:{},layerBounds:{},isInitialized:!1}},computed:(0,l.A)((0,l.A)({},(0,a.aH)(["collections","activeCollections"])),{},{activeCollectionObjects:function(){var e=this;return console.log("Computing active collection objects:",{activeIds:this.activeCollections,allCollections:this.collections}),this.collections.filter((function(t){return e.activeCollections.includes(t.id)}))}}),mounted:function(){console.log("MapView mounted"),N(),this.initMap()},methods:{initMap:function(){var e=this;console.log("MapView - Initializing map"),this.isInitialized||this.$nextTick((function(){try{e.map=G().map("map").setView([0,0],2),G().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:" OpenStreetMap contributors",maxZoom:19}).addTo(e.map),e.map.on("moveend",(function(){console.log("MapView - Map moved:",{center:e.map.getCenter(),zoom:e.map.getZoom()})})),setTimeout((function(){e.map&&(e.map.invalidateSize(),e.isInitialized=!0)}),200)}catch(t){console.error("Error initializing map:",t)}}))},loadCollectionLayer:function(e){var t=this;return(0,_.A)((0,S.A)().mark((function o(){var n,r,i,c;return(0,S.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:if(t.map&&t.isInitialized){o.next=4;break}return console.warn("Map not initialized yet, retrying in 200ms"),setTimeout((function(){return t.loadCollectionLayer(e)}),200),o.abrupt("return");case 4:return o.prev=4,console.log("MapView - Loading collection:",e.id),t.layerGroups[e.id]||(t.layerGroups[e.id]=G().layerGroup()),n=t.layerGroups[e.id],r=t.getCollectionColor(e.id),n.clearLayers(),o.next=12,B(e.id);case 12:i=o.sent,c=K(i),console.log("MapView - Collection type:",c),o.t0=c,o.next="feature"===o.t0?18:"coverage"===o.t0?21:"tiles"===o.t0?24:27;break;case 18:return o.next=20,t.handleFeatureCollection(e,n,r);case 20:return o.abrupt("break",28);case 21:return o.next=23,t.handleCoverageCollection(e,n);case 23:return o.abrupt("break",28);case 24:return o.next=26,t.handleTileCollection(e,n);case 26:return o.abrupt("break",28);case 27:console.warn("MapView - Unknown collection type: ".concat(c));case 28:t.map.hasLayer(n)||n.addTo(t.map),o.next=34;break;case 31:o.prev=31,o.t1=o["catch"](4),console.error("MapView - Error loading collection ".concat(e.id,":"),o.t1);case 34:case"end":return o.stop()}}),o,null,[[4,31]])})))()},handleFeatureCollection:function(e,t,o){var n=this;return(0,_.A)((0,S.A)().mark((function r(){var i,c,l,a;return(0,S.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,X(e.id);case 3:return c=r.sent,r.next=6,$(e.id,{limit:1e3});case 6:l=r.sent,(null===(i=l.features)||void 0===i?void 0:i.length)>0&&(a=G().geoJSON(l.features,{style:function(e){return{color:o,weight:2,opacity:.8,fillOpacity:.35}},pointToLayer:function(e,t){return G().circleMarker(t,{radius:8,fillColor:o,color:"#000",weight:1,opacity:1,fillOpacity:.8})},onEachFeature:function(e,t){if(e.properties){var o=n.createPopupContent(e.properties,c);t.bindPopup(o,{maxWidth:300,closeButton:!0,autoPan:!0})}}}),t.addLayer(a),n.layerBounds[e.id]=a.getBounds(),n.$nextTick((function(){n.updateMapView()}))),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](0),console.error("MapView - Error loading features:",r.t0);case 13:case"end":return r.stop()}}),r,null,[[0,10]])})))()},handleCoverageCollection:function(e,t){return(0,_.A)((0,S.A)().mark((function o(){var n,r;return(0,S.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:n=Z(e.id),r=G().tileLayer.wms(n,{layers:e.id,format:"image/png",transparent:!0,version:"1.3.0"}),t.addLayer(r);case 3:case"end":return o.stop()}}),o)})))()},handleTileCollection:function(e,t){return(0,_.A)((0,S.A)().mark((function o(){var n,r,i,c,l,a,s;return(0,S.A)().wrap((function(o){while(1)switch(o.prev=o.next){case 0:return o.prev=0,o.next=3,W(e.id);case 3:r=o.sent,console.log("MapView - Tile info:",r),i=null===(n=r.links)||void 0===n?void 0:n.some((function(e){return"application/vnd.mapbox-vector-tile"===e.type})),i?(c=H(e.id,"mvt"),l=G().tileLayer(c),t.addLayer(l)):(a=H(e.id),s=G().tileLayer(a),t.addLayer(s)),o.next=12;break;case 9:o.prev=9,o.t0=o["catch"](0),console.error("MapView - Error loading tiles:",o.t0);case 12:case"end":return o.stop()}}),o,null,[[0,9]])})))()},updateMapView:function(){var e=this;if(this.map&&this.isInitialized)try{var t=this.activeCollectionObjects;if(0===t.length)return;if(1===t.length){var o=this.layerBounds[t[0].id];o&&o.isValid()&&this.map.setView(o.getCenter(),this.map.getBoundsZoom(o))}else{var n=G().latLngBounds([]);t.forEach((function(t){var o=e.layerBounds[t.id];o&&o.isValid()&&n.extend(o)})),n.isValid()&&this.map.setView(n.getCenter(),this.map.getBoundsZoom(n))}}catch(r){console.error("Error updating map view:",r)}},removeCollection:function(e){var t=this;if(this.map&&this.layerGroups[e])try{var o=this.layerGroups[e];o.eachLayer((function(e){e.closePopup&&e.closePopup()})),this.map.hasLayer(o)&&this.map.removeLayer(o),o.clearLayers(),delete this.layerGroups[e],delete this.layerBounds[e],this.$nextTick((function(){t.updateMapView()}))}catch(n){console.error("Error removing collection:",n)}},createPopupContent:function(e,t){if(!e)return"No properties available";var o=document.createElement("div");return o.className="feature-popup",Object.entries(e).forEach((function(e){var n,r=(0,M.A)(e,2),i=r[0],c=r[1],l=null===t||void 0===t||null===(n=t.properties)||void 0===n?void 0:n[i];if(null!==c&&void 0!==c){var a=document.createElement("div");a.className="property-row";var s=document.createElement("strong");s.textContent=(null===l||void 0===l?void 0:l.title)||i,s.className="property-label";var u=document.createElement("span");u.textContent=c,u.className="property-value",a.appendChild(s),a.appendChild(document.createTextNode(": ")),a.appendChild(u),o.appendChild(a)}})),o},getCollectionColor:function(e){return this.layerColors[e]||(this.layerColors[e]=this.getRandomColor()),this.layerColors[e]},getRandomColor:function(){for(var e="0123456789ABCDEF",t="#",o=0;o<6;o++)t+=e[Math.floor(16*Math.random())];return t}},watch:{activeCollectionObjects:{handler:function(e){var t=this,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];console.log("Active collection objects changed:",{new:e,old:o}),this.map&&this.isInitialized?(o&&o.forEach((function(o){e.find((function(e){return e.id===o.id}))||(console.log("Removing collection layer:",o.id),t.removeCollection(o.id))})),e.forEach((function(e){o.find((function(t){return t.id===e.id}))||(console.log("Adding new collection layer:",e.id),t.$nextTick((function(){t.loadCollectionLayer(e)})))}))):console.warn("Map not initialized yet")},immediate:!0,deep:!0}}},Y=(0,b.A)(Q,[["render",I]]),ee=Y,te={name:"App",components:{Sidebar:T,MapView:ee},mounted:function(){this.fetchCollections()},methods:(0,l.A)({},(0,a.i0)(["fetchCollections"]))},oe=(0,b.A)(te,[["render",c]]),ne=oe;o(5276),o(4114),o(4554);const re=(0,a.y$)({state:{collections:[],activeCollections:[],loading:!1,error:null},mutations:{SET_COLLECTIONS:function(e,t){console.log("Mutation: SET_COLLECTIONS",t),e.collections=t},SET_ACTIVE_COLLECTIONS:function(e,t){console.log("Mutation: SET_ACTIVE_COLLECTIONS",t),e.activeCollections=t},TOGGLE_COLLECTION:function(e,t){console.log("Mutation: TOGGLE_COLLECTION",{collectionId:t,currentlyActive:e.activeCollections.includes(t)});var o=e.activeCollections.indexOf(t);-1===o?(e.activeCollections.push(t),console.log("Collection ".concat(t," activated. New active collections:"),e.activeCollections)):(e.activeCollections.splice(o,1),console.log("Collection ".concat(t," deactivated. New active collections:"),e.activeCollections))},SET_LOADING:function(e,t){console.log("Mutation: SET_LOADING",t),e.loading=t},SET_ERROR:function(e,t){console.log("Mutation: SET_ERROR",t),e.error=t}},actions:{fetchCollections:function(e){return(0,_.A)((0,S.A)().mark((function t(){var o,n;return(0,S.A)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=e.commit,console.log("Action: fetchCollections started"),o("SET_LOADING",!0),o("SET_ERROR",null),t.prev=4,t.next=7,F();case 7:n=t.sent,console.log("Action: fetchCollections success",n),o("SET_COLLECTIONS",n),t.next=16;break;case 12:t.prev=12,t.t0=t["catch"](4),console.error("Action: fetchCollections error:",t.t0),o("SET_ERROR",t.t0.message);case 16:return t.prev=16,o("SET_LOADING",!1),t.finish(16);case 19:case"end":return t.stop()}}),t,null,[[4,12,16,19]])})))()},toggleCollection:function(e,t){var o=e.commit,n=e.state;console.log("Action: toggleCollection",{collectionId:t,currentState:{collections:n.collections,activeCollections:n.activeCollections}}),o("TOGGLE_COLLECTION",t)}},getters:{isCollectionActive:function(e){return function(t){var o=e.activeCollections.includes(t);return console.log("Getter: isCollectionActive",{collectionId:t,isActive:o}),o}}}});var ie=o(5384),ce={en:{collections:"Collections",layers:"Layers",noCollections:"No collections available",toggleLayer:"Toggle Layer"},ar:{collections:"المجموعات",layers:"الطبقات",noCollections:"لا توجد مجموعات متاحة",toggleLayer:"تبديل الطبقة"}};const le=(0,ie.hU)({locale:"en",fallbackLocale:"en",messages:ce});var ae=(0,n.Ef)(ne);ae.use(re),ae.use(le),ae.mount("#app")}},t={};function o(n){var r=t[n];if(void 0!==r)return r.exports;var i=t[n]={exports:{}};return e[n].call(i.exports,i,i.exports,o),i.exports}o.m=e,(()=>{var e=[];o.O=(t,n,r,i)=>{if(!n){var c=1/0;for(u=0;u<e.length;u++){for(var[n,r,i]=e[u],l=!0,a=0;a<n.length;a++)(!1&i||c>=i)&&Object.keys(o.O).every((e=>o.O[e](n[a])))?n.splice(a--,1):(l=!1,i<c&&(c=i));if(l){e.splice(u--,1);var s=r();void 0!==s&&(t=s)}}return t}i=i||0;for(var u=e.length;u>0&&e[u-1][2]>i;u--)e[u]=e[u-1];e[u]=[n,r,i]}})(),(()=>{o.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return o.d(t,{a:t}),t}})(),(()=>{o.d=(e,t)=>{for(var n in t)o.o(t,n)&&!o.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}})(),(()=>{o.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{o.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{var e={524:0};o.O.j=t=>0===e[t];var t=(t,n)=>{var r,i,[c,l,a]=n,s=0;if(c.some((t=>0!==e[t]))){for(r in l)o.o(l,r)&&(o.m[r]=l[r]);if(a)var u=a(o)}for(t&&t(n);s<c.length;s++)i=c[s],o.o(e,i)&&e[i]&&e[i][0](),e[i]=0;return o.O(u)},n=self["webpackChunkpygeoapi_collections_viewer"]=self["webpackChunkpygeoapi_collections_viewer"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var n=o.O(void 0,[504],(()=>o(6698)));n=o.O(n)})();
//# sourceMappingURL=app.2575e33c.js.map